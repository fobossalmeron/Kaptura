<section id="portafolio">
  <div class="diagonalcont">
  <div class="diagonalpos black"></div>
  <div class="diagonalback"></div>
  </div>
  <main>
	<h2>Últimos Proyectos</h2>
  <script>
  //Parallax heights
  function parallaxresize(proyectselector, number, screen){
    var size = $("#coverer" + proyectselector + number).height();
    var mobilesize = $("#coverer" + proyectselector + number + "mob").height();

    if ($(window).width() < 700) {
    $("#" + proyectselector + number).css("height", mobilesize - 3);
//    console.log("Height de minitablet y es " + mobilesize);
    }
    else {
      $("#" + proyectselector + number).css("height", size - 3);
//      console.log("Height de minitablet y es " + size);
    }
  }
  </script>

	{% for proyect in site.proyects reversed %}
		<div class="proyect">
      <img class="main_image" src="{{site.baseurl}}images/portfolio/{{proyect.selector}}/{{proyect.logo}}">
			<div class="main_title">
			  <h3><b>PROD.</b> {{ proyect.title }}</h3>
        {% for sub in proyect.subtitles %}
			  <h4>{{ sub.sub }}</h4>
        {% endfor %}
			</div>
      <div class="columned">
        <div class="thecolumn"></div>
        {{ proyect.content }}
      </div>
      <div class="video_insert">
			     <iframe src="{{ proyect.video }}" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
      </div>

      <div id="{{proyect.selector}}1" class="parallaxParent">
        <img id="coverer{{proyect.selector}}1" class="coverer above-minitablet" src="{{site.baseurl}}images/layout/singlelinegrid.svg">
        <img id="coverer{{proyect.selector}}1mob" class="coverer minitablet" src="{{site.baseurl}}images/layout/singlelinegridminitablet.svg">
      	<div class="parallaxChild" style="background-image: url({{site.baseurl}}images/portfolio/{{proyect.selector}}/{{proyect.display_1}});">
        </div>
      </div>

      <script>
        $( document ).ready(function() {
          parallaxresize("{{proyect.selector}}", 1);
        });
        $( window ).resize(function() {
          parallaxresize("{{proyect.selector}}", 1);
        });
      </script>
      <div class="columnedbrief">
        <div class="thecolumn"></div>
  			<div class="brief">
  				<h3>Objetivo</h3>
  				<p>{{ proyect.brief }}</p>
  			</div>
  			<div class="solution">
  				<h3>Solución</h3>
  				<p>{{ proyect.solution }}</p>
  			</div>
      </div>

      {% if proyect.video2 %}
      <div class="video_insert">
			     <iframe src="{{ proyect.video2 }}" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
      </div>
      {% endif %}

  <!--    <div id="{{proyect.selector}}2" class="parallaxParent">
        <img id="coverer{{proyect.selector}}2" class="coverer above-minitablet" src="{{site.baseurl}}images/layout/doublelinegrid.svg">
        <img id="coverer{{proyect.selector}}2mob" class="coverer minitablet" src="{{site.baseurl}}images/layout/singlelinegridminitablet.svg">
      	<div class="parallaxChild" style="background-image: url({{site.baseurl}}images/portfolio/{{proyect.selector}}/{{proyect.display_2}});"></div>
      </div>

      <script>
      $( document ).ready(function() {
        parallaxresize("{{proyect.selector}}", 2);
      });
      $( window ).resize(function() {
          parallaxresize("{{proyect.selector}}", 2);
      });
    </script>-->

      <script>
      	// init controller
      	var controller = new ScrollMagic.Controller({globalSceneOptions: {triggerHook: "onEnter", duration: "200%"}});
      	// build scenes
      	new ScrollMagic.Scene({triggerElement: "#{{proyect.selector}}1"})
      					.setTween("#{{proyect.selector}}1 > div", {y: "100%", ease: Linear.easeNone})
      		//		.addIndicators()
      					.addTo(controller);
      	new ScrollMagic.Scene({triggerElement: "#{{proyect.selector}}2"})
      					.setTween("#{{proyect.selector}}2 > div", {y: "100%", ease: Linear.easeNone})
      			//	.addIndicators()
      					.addTo(controller);
                /*
      	new ScrollMagic.Scene({triggerElement: "#parallax3"})
      					.setTween("#parallax3 > div", {y: "80%", ease: Linear.easeNone})
      					.addIndicators()
      					.addTo(controller);*/
      </script>

			</div>
	{% endfor %}
  </main>
</section>
